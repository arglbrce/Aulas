\documentclass[table]{beamer}

\usepackage{GCS-Aula_00-Style}

\input{GCS-Aula_00-Title.tex}

%----------------------------------------------------------------------------------------
%	PRESENTATION SLIDES
%----------------------------------------------------------------------------------------

%------------------------------------------------

\begin{frame}
\begin{block}{\centerline{Mantis - Issue Tracking}}
\centerline{Parte 2}
\end{block}

\end{frame}

%------------------------------------------------

\begin{frame}

\frametitle{Mantis}

\begin{itemize}
	\item Instalação Linux:
	\begin{itemize}
		\item \texttt{apt-get install mantis}
	\end{itemize}
	\item Documentação disponível em:
	\begin{itemize}
		\item \url{http://www.mantisbt.org/wiki/doku.php}
	\end{itemize}
	\item Download:
	\begin{itemize}
		\item \url{http://www.mantisbt.org/download.php}
	\end{itemize}
\end{itemize}

\end{frame}

%------------------------------------------------

\begin{frame}

\frametitle{Mantis}

\begin{itemize}
	\item Acesse o endereço:
	\begin{itemize}
		\item \url{http://192.168.56.102/mantis/}
		\item Usuário: \texttt{administrator}
		\item Senha: \texttt{gcs123}
	\end{itemize}
\end{itemize}

\end{frame}

%------------------------------------------------

\begin{frame}

\frametitle{Mantis}

\begin{itemize}
	\item Projetos:
	\begin{itemize}
		\item Os projetos determinam um grupo de trabalho onde estão envolvidos:
		\begin{itemize}
			\item Usuários
			\item Papeis
			\item Relatos / Categorias
		\end{itemize}
		\item Pode estar relacionado a um sistema ou qualquer ou tipo de trabalho que a equipe desempenhe:
		\begin{itemize}
			\item Prova de conceito
			\item Otimização de servidores
			\item Configuração de rede
			\item Outros
		\end{itemize}
	\end{itemize}
\end{itemize}

\end{frame}

%------------------------------------------------

\begin{frame}

\frametitle{Mantis}

\begin{itemize}
	\item Projetos:
	\begin{itemize}
		\item Para criar um projeto basta clicar no menu \texttt{Gerenciar > Gerenciar Projetos}
		\item Clicar no botão \texttt{Criar Novo Projeto}
		\item Preencher os campos.
		\item Clicar no botão \texttt{Adicionar Projeto}
	\end{itemize}
\end{itemize}

\end{frame}

%------------------------------------------------

\begin{frame}

\frametitle{Mantis}

\begin{itemize}
	\item Projetos: \texttt{Gerenciar > Gerenciar Projetos}
\begin{figure}
\includegraphics[scale=0.3]{./images/mantis-01.png}
\end{figure}
\end{itemize}

\end{frame}

%------------------------------------------------

\begin{frame}

\frametitle{Mantis}

\begin{itemize}
	\item Projetos: \texttt{dv-generator}
\begin{figure}
\includegraphics[scale=0.3]{./images/mantis-02.png}
\end{figure}
\end{itemize}

\end{frame}

%------------------------------------------------

\begin{frame}

\frametitle{Mantis}

\begin{itemize}
	\item Categorias:
	\begin{itemize}
		\item Definem as categorias dos relatos. Ex.:
		\begin{itemize}
			\item Erro
			\item Mudança
			\item Nova funcionalidade
		\end{itemize}
	\end{itemize}
	\item Versões:
	\begin{itemize}
		\item Define as versões do projeto de software que estão sob o controle de mudanças
		\begin{itemize}
			\item \texttt{V 1.0}
			\item \texttt{V 1.1}
		\end{itemize}
	\end{itemize}
\end{itemize}

\end{frame}

%------------------------------------------------

\begin{frame}

\frametitle{Mantis}

\begin{itemize}
	\item Categorias / Versões: 
\begin{figure}
\includegraphics[scale=0.3]{./images/mantis-03.png}
\end{figure}
\end{itemize}

\end{frame}

%------------------------------------------------

\begin{frame}

\frametitle{Mantis}

\begin{itemize}
	\item Papéis:
	\begin{itemize}
		\item São as funções desempenhadas pelos usuário do projeto:
		\begin{itemize}
			\item Visualizador
			\item Relator
			\item Atualizador
			\item Desenvolvedor
			\item Gerente
			\item Administrador
		\end{itemize}
	\end{itemize}
\end{itemize}

\end{frame}

%------------------------------------------------

\begin{frame}

\frametitle{Mantis}

\begin{itemize}
	\item Usuários:
	\begin{itemize}
		\item Para acessar o Mantis é necessário ter um usuário habilitado.
		\item Devem desempenhar algum papel em algum projeto.
		\item Para criar um usuário faça:
		\begin{itemize}
			\item Logar com um \texttt{administrador}
			\item Clicar no menu \texttt{Gerenciar > Gerenciar Usuários}
			\item Clicar no botão \texttt{Criar Nova Conta}
			\item Preencher os dados e clicar no botão \texttt{Criar Usuário}
			\item Atualizar a senha
			\item Atualizar papel no projeto
			\item Atualizar projeto padrão
		\end{itemize}
	\end{itemize}
\end{itemize}

\end{frame}

%------------------------------------------------

\begin{frame}

\frametitle{Mantis}

\begin{itemize}
	\item Usuários: Listagem
\begin{figure}
\includegraphics[scale=0.3]{./images/mantis-04.png}
\end{figure}
\end{itemize}

\end{frame}

%------------------------------------------------

\begin{frame}

\frametitle{Mantis}

\begin{itemize}
	\item Usuários: Novo usuário
\begin{figure}
\includegraphics[scale=0.3]{./images/mantis-05.png}
\end{figure}
\end{itemize}

\end{frame}

%------------------------------------------------

\begin{frame}

\frametitle{Mantis}

\begin{itemize}
	\item Usuários: Atualizando usuário
\begin{figure}
\includegraphics[scale=0.3]{./images/mantis-06.png}
\end{figure}
\end{itemize}

\end{frame}

%------------------------------------------------

\begin{frame}

\frametitle{Mantis}

\begin{itemize}
	\item Usuários: Exercício - crie os seguintes usuários
\end{itemize}

\begin{center}
\begin{tabular}{| c | c | c | p{1cm} |}\hline
{\bf Nome Usuário} \cellcolor{green} & {\bf Nome Verdadeiro} \cellcolor{green} & {\bf Nível de Acesso} \cellcolor{green} & {\bf Habilitado} \cellcolor{green} \\ \hline \hline
andre & André da Silva & atualizador & X\\ \hline
jenkins & Jenkins CI & desenvolvedor & X\\ \hline
joao & João da Silva & gerente & X\\ \hline
jose & José da Silva & desenvolvedor & X\\ \hline
julia & Júlia da Silva & visualizador & X\\ \hline
maria & Maria da Silva & relator & X\\ \hline
\end{tabular}
\end{center}

\end{frame}

%------------------------------------------------

\begin{frame}

\frametitle{Mantis}

\begin{itemize}
	\item Relatos:
	\begin{itemize}
		\item São as solicitações de mudanças criadas pelos relatores e tratadas pelos gerentes e desenvolvedores.
		\item Para criar um relato faça:
		\begin{itemize}
			\item Clique no menu \texttt{Relatar Caso}
			\item Preencha os dados.
			\item Clique no botão \texttt{Enviar Relatório}
		\end{itemize}
		\item Inicia no status \texttt{Novo}
	\end{itemize}
\end{itemize}

\end{frame}

%------------------------------------------------

\begin{frame}

\frametitle{Mantis}

\begin{itemize}
	\item Relatos:
\begin{figure}
\includegraphics[scale=0.3]{./images/mantis-07.png}
\end{figure}
\end{itemize}

\end{frame}

%------------------------------------------------

\begin{frame}

\frametitle{Mantis}

\begin{itemize}
	\item Status: Permite definir a situação de um relato
	\begin{itemize}
		\item {\bf Novo:} Relato registrado e ainda não tratado
		\item {\bf Retorno:} Relato retornado para o relator
		\item {\bf Admitido:} Relato aceito para trabalho
		\item {\bf Confirmado:} Relato confirmado para execução
		\item {\bf Atribuído:} Relato atribuído ao executor
		\item {\bf Resolvido:} Relato resolvido pelo executor
		\item {\bf Fechado:} Relato não resolvido e fechado
	\end{itemize}
\end{itemize}

\end{frame}

%------------------------------------------------

\begin{frame}

\frametitle{Mantis}

\begin{itemize}
	\item Status: Alterando utilizado a edição do relato
\begin{figure}
\includegraphics[scale=0.3]{./images/mantis-08.png}
\end{figure}
\end{itemize}

\end{frame}

%------------------------------------------------

\begin{frame}

\frametitle{Mantis}

\begin{itemize}
	\item Status: Altere o status: Novo $\to$ Admitido
\begin{figure}
\includegraphics[scale=0.3]{./images/mantis-09.png}
\end{figure}
\end{itemize}

\end{frame}

%------------------------------------------------

\begin{frame}

\frametitle{Mantis}

\begin{itemize}
	\item Fluxo de trabalho proposto:
	\item * Crie um relato de erro e siga o fluxo proposto
\end{itemize}

\end{frame}

%------------------------------------------------

\begin{frame}

\frametitle{Mantis}

\begin{itemize}
	\item Personalizando o Mantis:
	\item Utilizar o \texttt{hooks post-commit} do subversion
\end{itemize}

\end{frame}

%------------------------------------------------

\begin{frame}[fragile]

\frametitle{Mantis}

\begin{itemize}
	\item Personalizando o Mantis:
	\begin{itemize}
		\item Editar o arquivo: \begin{verbatim}/etc/mantis/config_local.php
\end{verbatim}
		\item \begin{verbatim}sudo nano /etc/mantis/config_local.php
\end{verbatim}
		\item \begin{verbatim}$g_enable_email_notification = 'ON';
\end{verbatim} (Gera usuários com senha em branco)
		\item \begin{verbatim}$g_source_control_account = 'svn';
\end{verbatim} (Usuário \texttt{svn} criado no mantis)
		\item \begin{verbatim}$g_source_control_regexp  = 
			'/\b(?:bug|issue)\s*[#]{0,1}(\d+)\b/i'; 
\end{verbatim}  (Expressão regular que verifica por texto padrão no comentário do commit. Por exemplo, issue \#53 ou bug \#74)
	\end{itemize}
	
\end{itemize}

\end{frame}

%------------------------------------------------

\begin{frame}[fragile]

\frametitle{Mantis}

\begin{itemize}
	\item Personalizando o Mantis:
	\begin{itemize}
		\item Fechando casos do mantis automaticamente:
		\item \begin{verbatim}$g_source_control_set_status_to     = RESOLVED;
\end{verbatim} (Altera o estado do item para RESOLVED)
		\item \begin{verbatim}$g_source_control_set_resolution_to = FIXED;
\end{verbatim} (Altera a resolução do item para FIXED)
		\item \begin{verbatim}$g_source_control_account = 'svn';
\end{verbatim} (Usuário \texttt{svn} criado no mantis)
		\item \begin{verbatim}$g_source_control_fixed_regexp  = 
		'/\bfix(?:ed|es)\s+(?:bug|issue)?\s*[#]{0,1}(\d+)\b/i';
\end{verbatim}  (Expressão regular que verifica por texto padrão no comentário do commit e conclui a Issue. Por exemplo, fix issue \#53 ou fixed bug \#74)
	\end{itemize}
	
\end{itemize}

\end{frame}

%------------------------------------------------

\begin{frame}[fragile]

\frametitle{Mantis}

\begin{itemize}
	\item Configurando o \texttt{post-commit} svn:
	\begin{itemize}
		\item Edite o arquivo:
		\item \begin{verbatim}~/curso-gcs/repositorio-svn/teste/hooks/post-commit
\end{verbatim}
		\item Insira o seguinte conteúdo:
	\end{itemize}
\end{itemize}

{\small
\begin{verbatim}
#!/bin/bash

REPOS="$1"
REV="$2"

info=$(svnlook info -r $REV $REPOS)
changed=$(svnlook changed -r $REV $REPOS)

/usr/bin/php -q /usr/share/mantis/www/scripts/checkin.php 
<<< $info$'\n'$changed
\end{verbatim}
}

\end{frame}

%------------------------------------------------

\begin{frame}[fragile]

\frametitle{Mantis}

\begin{itemize}
	\item Personalizando o Mantis:
	\begin{itemize}
		\item Configurando o \texttt{post-commit} svn:
		\item Mude as permissões do arquivo:
		\item \begin{verbatim}
~/curso-gcs/repositorio-svn/teste/hooks/post-commit
\end{verbatim}
		\item \begin{verbatim}chmod ug+x post-commit
\end{verbatim}
		\item \begin{verbatim}chgrp root post-commit
\end{verbatim}
		\item Inicie o servidor SVN como sudo:
		\begin{verbatim}
sudo svnserve -d -r ~/curso-gcs/repositorio-svn/
\end{verbatim}
	\end{itemize}
	
\end{itemize}

\end{frame}


%------------------------------------------------

\begin{frame}[fragile]

\frametitle{Mantis}

\begin{itemize}
	\item Crie um relato no mantis e anote o número
	\begin{itemize}
		\item Faça um novo commit no SVN e acrescente o texto: fixed bug \#$<$número do relato$>$
		\item Veja o comentário que apareceu no relato
	\end{itemize}
	
\end{itemize}

\end{frame}

%------------------------------------------------



%----------------------------------------------------------------------------------------

\end{document}